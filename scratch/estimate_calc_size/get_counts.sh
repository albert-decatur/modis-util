# for every unique HURDAT2 id in 150 mile buffered hurdat2 sshws > 1 points, find landmask tiles that overlap buffered hurricane points that intersect natural earth land
a="'"; echo "copy ( select distinct(id) from allhurricanes_hurdat2_onlyhurricanepoints_150milebuffer_sin ) to stdout;" | psql modis-land-mask  | parallel --gnu 'echo "copy ( select b.id,round(a.h,0) as h,round(a.v,0) as h from landmask as a, allhurricanes_hurdat2_onlyhurricanepoints_150milebuffer_sin as b, ne_10m_land_sin as c where a.geom && b.geom and b.geom && c.geom and st_intersects(b.geom,c.geom) and st_intersects(a.geom,b.geom) and b.id = '$a'{}'$a' ) to stdout;"' | psql modis-land-mask
